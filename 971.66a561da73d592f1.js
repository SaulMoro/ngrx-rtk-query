"use strict";(self.webpackChunkngrx_rtk_query_app=self.webpackChunkngrx_rtk_query_app||[]).push([[971],{971:(B,P,c)=>{c.r(P),c.d(P,{PostsModule:()=>u});var r=c(6895),a=c(433),_=c(5737),y=c(9653),x=c(7729),h=c(8699),t=c(4650);const T=(0,x.ni)({baseUrl:"/"}),C=(0,x.XD)(T,{maxRetries:6}),f=(0,h.LC)({reducerPath:"postsApi",baseQuery:C,tagTypes:["Posts"],endpoints:n=>({getPosts:n.query({query:()=>({url:"posts"}),providesTags:e=>e?[...e.map(({id:o})=>({type:"Posts",id:o})),{type:"Posts",id:"LIST"}]:[{type:"Posts",id:"LIST"}]}),addPost:n.mutation({query:e=>({url:"posts",method:"POST",body:e}),invalidatesTags:[{type:"Posts",id:"LIST"}]}),getPost:n.query({query:e=>`posts/${e}`,providesTags:(e,o,s)=>[{type:"Posts",id:s}]}),updatePost:n.mutation({query:e=>{const{id:o,...s}=e;return{url:`posts/${o}`,method:"PUT",body:s}},invalidatesTags:(e,o,{id:s})=>[{type:"Posts",id:s}]}),deletePost:n.mutation({query:e=>({url:`posts/${e}`,method:"DELETE"}),invalidatesTags:(e,o,s)=>[{type:"Posts",id:s}]})})}),{useAddPostMutation:Z,useDeletePostMutation:v,useGetPostQuery:I,useGetPostsQuery:b,useUpdatePostMutation:L}=f;class p{}p.\u0275fac=function(e){return new(e||p)},p.\u0275mod=t.oAB({type:p}),p.\u0275inj=t.cJS({imports:[y.Aw.forFeature(f.reducerPath,f.reducer,{metaReducers:[f.metareducer]})]});const A=function(n){return["/posts",n]};function Q(n,e){if(1&n&&(t.TgZ(0,"li")(1,"a",6),t._uU(2),t.qZA()()),2&n){const o=e.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,A,o.id)),t.xp6(1),t.Oqu(o.name)}}function F(n,e){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,Q,3,4,"li",5),t.qZA()),2&n){const o=t.oxw().ngIf,s=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",s.trackByFn)}}function J(n,e){1&n&&(t.TgZ(0,"p",7),t._uU(1,"No posts :("),t.qZA())}function M(n,e){if(1&n&&(t.ynx(0),t.YNc(1,F,2,2,"div",2),t.YNc(2,J,2,0,"ng-template",null,4,t.W1O),t.BQk()),2&n){const o=e.ngIf,s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",o.length)("ngIfElse",s)}}function N(n,e){1&n&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function w(n,e){if(1&n&&(t.TgZ(0,"section",1),t.YNc(1,M,4,2,"ng-container",2),t.YNc(2,N,2,0,"ng-template",null,3,t.W1O),t.qZA()),2&n){const o=e.ngIf,s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",o.data)("ngIfElse",s)}}class d{constructor(){this.postsQuery$=b()}trackByFn(e,o){return o.id}}function q(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.addNewPost())}),t._uU(1),t.qZA()}if(2&n){const o=e.ngIf,s=t.oxw();t.Q6J("disabled",s.postNameFormControl.invalid||o.isLoading),t.xp6(1),t.hij(" ",o.isLoading?"Adding...":"Add Post"," ")}}d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-posts-list"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(e,o){1&e&&(t.YNc(0,w,4,2,"section",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.postsQuery$))},dependencies:[r.sg,r.O5,_.rH,r.Ov],encapsulation:2,changeDetection:0});class g{constructor(){this.addPost=Z(),this.postNameFormControl=new a.p4("",[a.kI.required])}addNewPost(){this.addPost.dispatch({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}}g.\u0275fac=function(e){return new(e||g)},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-posts-manager"]],decls:12,vars:4,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],["class","btn btn-primary m-4",3,"disabled","click",4,"ngIf"],[1,"text-xl","font-semibold"],[1,"btn","btn-primary","m-4",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"section",0)(1,"div"),t._UZ(2,"input",1),t.YNc(3,q,2,2,"button",2),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"h1",3),t._uU(6,"Posts List"),t.qZA(),t._UZ(7,"app-posts-list")(8,"hr"),t.TgZ(9,"h1",3),t._uU(10,"Posts List with duplicate subscription"),t.qZA(),t._UZ(11,"app-posts-list"),t.qZA()),2&e&&(t.xp6(2),t.Q6J("formControl",o.postNameFormControl),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,o.addPost.state$)))},dependencies:[r.O5,a.Fj,a.JJ,a.oH,d,r.Ov],encapsulation:2,changeDetection:0});var U=c(8505);function k(n,e){1&n&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function D(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(4);return t.KtG(i.toggleEdit())}),t._uU(1),t.qZA()}if(2&n){const o=e.ngIf,s=t.oxw().ngIf,i=t.oxw(2).ngIf;t.Q6J("disabled",i.isLoading||s.isLoading||o.isLoading),t.xp6(1),t.hij(" ",null!=o&&o.isLoading?"Updating...":"Edit"," ")}}function E(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",8),t.YNc(1,D,2,2,"button",9),t.ALo(2,"async"),t.TgZ(3,"button",10),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(3);return t.KtG(i.deletePost())}),t._uU(4),t.qZA(),t.TgZ(5,"button",10),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(2).ngIf;return t.KtG(i.refetch())}),t._uU(6),t.qZA()()}if(2&n){const o=e.ngIf,s=t.oxw(2).ngIf,i=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,5,i.updatePostMutation.state$)),t.xp6(2),t.Q6J("disabled",s.isLoading||o.isLoading),t.xp6(1),t.hij(" ",null!=o&&o.isLoading?"Deleting...":"Delete"," "),t.xp6(1),t.Q6J("disabled",s.isFetching),t.xp6(1),t.hij(" ",s.isFetching?"Fetching...":"Refresh"," ")}}function Y(n,e){if(1&n&&(t.ynx(0),t.YNc(1,E,7,7,"div",7),t.ALo(2,"async"),t.BQk()),2&n){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.deletePostMutation.state$))}}function O(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",12),t._UZ(1,"input",13),t.TgZ(2,"button",14),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(3);return t.KtG(i.updatePost())}),t._uU(3),t.qZA(),t.TgZ(4,"button",14),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(3);return t.KtG(i.toggleEdit())}),t._uU(5,"Cancel"),t.qZA()()}if(2&n){const o=e.ngIf,s=t.oxw(3);t.xp6(1),t.Q6J("formControl",s.postFormControl),t.xp6(1),t.Q6J("disabled",o.isLoading),t.xp6(1),t.hij(" ",null!=o&&o.isLoading?"Updating...":"Update"," "),t.xp6(1),t.Q6J("disabled",o.isLoading)}}function S(n,e){if(1&n&&(t.YNc(0,O,6,4,"div",11),t.ALo(1,"async")),2&n){const o=t.oxw(2);t.Q6J("ngIf",t.lcZ(1,1,o.updatePostMutation.state$))}}function $(n,e){if(1&n&&(t.TgZ(0,"section",1)(1,"div")(2,"h1",2),t._uU(3),t.qZA(),t.YNc(4,k,2,0,"small",3),t.qZA(),t.YNc(5,Y,3,3,"ng-container",4),t.YNc(6,S,2,3,"ng-template",null,5,t.W1O),t.TgZ(8,"pre",6),t._uU(9),t.ALo(10,"json"),t.qZA()()),2&n){const o=e.ngIf,s=t.MAs(7),i=t.oxw();t.xp6(3),t.Oqu(null==o||null==o.data?null:o.data.name),t.xp6(1),t.Q6J("ngIf",o.isFetching),t.xp6(1),t.Q6J("ngIf",!i.isEditing)("ngIfElse",s),t.xp6(4),t.Oqu(t.lcZ(10,5,o.data))}}class m{constructor(e,o){this.route=e,this.router=o,this.postQuery$=I(+this.route.snapshot.params.id,{pollingInterval:5e3}).pipe((0,U.b)(s=>this.postFormControl.setValue(s.data?.name??""))),this.updatePostMutation=L(),this.deletePostMutation=v(),this.postFormControl=new a.p4(""),this.isEditing=!1}updatePost(){this.updatePostMutation.dispatch({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation.dispatch(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing=!this.isEditing}}m.\u0275fac=function(e){return new(e||m)(t.Y36(_.gz),t.Y36(_.F0))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-post-detail"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],["class","flex items-center space-x-4",4,"ngIf"],[1,"flex","items-center","space-x-4"],["class","btn-outline btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn-outline","btn-primary",3,"disabled","click"],["class","space-x-4",4,"ngIf"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,o){1&e&&(t.YNc(0,$,11,7,"section",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.postQuery$))},dependencies:[r.O5,a.Fj,a.JJ,a.oH,r.Ov,r.Ts],encapsulation:2,changeDetection:0});const j=[{path:"",component:g},{path:":id",component:m}];class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[_.Bz.forChild(j),_.Bz]});class u{}u.\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[r.ez,l,a.u5,a.UX,p]})}}]);
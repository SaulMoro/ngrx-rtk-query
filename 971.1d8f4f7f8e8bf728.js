"use strict";(self.webpackChunkngrx_rtk_query_app=self.webpackChunkngrx_rtk_query_app||[]).push([[971],{971:(j,u,c)=>{c.r(u),c.d(u,{PostsModule:()=>$});var r=c(6895),a=c(433),l=c(5737),d=c(9653),g=c(7729),_=c(5091),t=c(4650);const m=(0,_.ni)({baseUrl:"/"}),f=(0,g.XD)(m,{maxRetries:6}),p=(0,_.LC)({reducerPath:"postsApi",baseQuery:f,tagTypes:["Posts"],endpoints:o=>({getPosts:o.query({query:()=>({url:"posts"}),providesTags:e=>e?[...e.map(({id:n})=>({type:"Posts",id:n})),{type:"Posts",id:"LIST"}]:[{type:"Posts",id:"LIST"}]}),addPost:o.mutation({query:e=>({url:"posts",method:"POST",body:e}),invalidatesTags:[{type:"Posts",id:"LIST"}]}),getPost:o.query({query:e=>`posts/${e}`,providesTags:(e,n,s)=>[{type:"Posts",id:s}]}),updatePost:o.mutation({query:e=>{const{id:n,...s}=e;return{url:`posts/${n}`,method:"PUT",body:s}},invalidatesTags:(e,n,{id:s})=>[{type:"Posts",id:s}]}),deletePost:o.mutation({query:e=>({url:`posts/${e}`,method:"DELETE"}),invalidatesTags:(e,n,s)=>[{type:"Posts",id:s}]})})}),{useAddPostMutation:P,useDeletePostMutation:x,useGetPostQuery:y,useGetPostsQuery:h,useUpdatePostMutation:C}=p;let T=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.Aw.forFeature(p.reducerPath,p.reducer,{metaReducers:[p.metareducer]})]}),o})();const Z=function(o){return["/posts",o]};function v(o,e){if(1&o&&(t.TgZ(0,"li")(1,"a",6),t._uU(2),t.qZA()()),2&o){const n=e.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,Z,n.id)),t.xp6(1),t.Oqu(n.name)}}function I(o,e){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,v,3,4,"li",5),t.qZA()),2&o){const n=t.oxw().ngIf,s=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",s.trackByFn)}}function L(o,e){1&o&&(t.TgZ(0,"p",7),t._uU(1,"No posts :("),t.qZA())}function b(o,e){if(1&o&&(t.ynx(0),t.YNc(1,I,2,2,"div",2),t.YNc(2,L,2,0,"ng-template",null,4,t.W1O),t.BQk()),2&o){const n=e.ngIf,s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.length)("ngIfElse",s)}}function Q(o,e){1&o&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function A(o,e){if(1&o&&(t.TgZ(0,"section",1),t.YNc(1,b,4,2,"ng-container",2),t.YNc(2,Q,2,0,"ng-template",null,3,t.W1O),t.qZA()),2&o){const n=e.ngIf,s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.data)("ngIfElse",s)}}let M=(()=>{class o{constructor(){this.postsQuery$=h()}trackByFn(n,s){return s.id}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-list"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(n,s){1&n&&(t.YNc(0,A,4,2,"section",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.postsQuery$))},dependencies:[r.sg,r.O5,l.rH,r.Ov],encapsulation:2,changeDetection:0}),o})();function F(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.addNewPost())}),t._uU(1),t.qZA()}if(2&o){const n=e.ngIf,s=t.oxw();t.Q6J("disabled",s.postNameFormControl.invalid||n.isLoading),t.xp6(1),t.hij(" ",n.isLoading?"Adding...":"Add Post"," ")}}let J=(()=>{class o{constructor(){this.addPost=P(),this.postNameFormControl=new a.p4("",[a.kI.required])}addNewPost(){this.addPost.dispatch({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-manager"]],decls:12,vars:4,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],["class","btn btn-primary m-4",3,"disabled","click",4,"ngIf"],[1,"text-xl","font-semibold"],[1,"btn","btn-primary","m-4",3,"disabled","click"]],template:function(n,s){1&n&&(t.TgZ(0,"section",0)(1,"div"),t._UZ(2,"input",1),t.YNc(3,F,2,2,"button",2),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"h1",3),t._uU(6,"Posts List"),t.qZA(),t._UZ(7,"app-posts-list")(8,"hr"),t.TgZ(9,"h1",3),t._uU(10,"Posts List with duplicate subscription"),t.qZA(),t._UZ(11,"app-posts-list"),t.qZA()),2&n&&(t.xp6(2),t.Q6J("formControl",s.postNameFormControl),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,s.addPost.state$)))},dependencies:[r.O5,a.Fj,a.JJ,a.oH,M,r.Ov],encapsulation:2,changeDetection:0}),o})();var N=c(8505);function w(o,e){1&o&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function q(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4);return t.KtG(i.toggleEdit())}),t._uU(1),t.qZA()}if(2&o){const n=e.ngIf,s=t.oxw().ngIf,i=t.oxw(2).ngIf;t.Q6J("disabled",i.isLoading||s.isLoading||n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Updating...":"Edit"," ")}}function D(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",8),t.YNc(1,q,2,2,"button",9),t.ALo(2,"async"),t.TgZ(3,"button",10),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.deletePost())}),t._uU(4),t.qZA(),t.TgZ(5,"button",10),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2).ngIf;return t.KtG(i.refetch())}),t._uU(6),t.qZA()()}if(2&o){const n=e.ngIf,s=t.oxw(2).ngIf,i=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,5,i.updatePostMutation.state$)),t.xp6(2),t.Q6J("disabled",s.isLoading||n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Deleting...":"Delete"," "),t.xp6(1),t.Q6J("disabled",s.isFetching),t.xp6(1),t.hij(" ",s.isFetching?"Fetching...":"Refresh"," ")}}function U(o,e){if(1&o&&(t.ynx(0),t.YNc(1,D,7,7,"div",7),t.ALo(2,"async"),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.deletePostMutation.state$))}}function k(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"div",12),t._UZ(1,"input",13),t.TgZ(2,"button",14),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.updatePost())}),t._uU(3),t.qZA(),t.TgZ(4,"button",14),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(3);return t.KtG(i.toggleEdit())}),t._uU(5,"Cancel"),t.qZA()()}if(2&o){const n=e.ngIf,s=t.oxw(3);t.xp6(1),t.Q6J("formControl",s.postFormControl),t.xp6(1),t.Q6J("disabled",n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Updating...":"Update"," "),t.xp6(1),t.Q6J("disabled",n.isLoading)}}function E(o,e){if(1&o&&(t.YNc(0,k,6,4,"div",11),t.ALo(1,"async")),2&o){const n=t.oxw(2);t.Q6J("ngIf",t.lcZ(1,1,n.updatePostMutation.state$))}}function Y(o,e){if(1&o&&(t.TgZ(0,"section",1)(1,"div")(2,"h1",2),t._uU(3),t.qZA(),t.YNc(4,w,2,0,"small",3),t.qZA(),t.YNc(5,U,3,3,"ng-container",4),t.YNc(6,E,2,3,"ng-template",null,5,t.W1O),t.TgZ(8,"pre",6),t._uU(9),t.ALo(10,"json"),t.qZA()()),2&o){const n=e.ngIf,s=t.MAs(7),i=t.oxw();t.xp6(3),t.Oqu(null==n||null==n.data?null:n.data.name),t.xp6(1),t.Q6J("ngIf",n.isFetching),t.xp6(1),t.Q6J("ngIf",!i.isEditing)("ngIfElse",s),t.xp6(4),t.Oqu(t.lcZ(10,5,n.data))}}const O=[{path:"",component:J},{path:":id",component:(()=>{class o{constructor(n,s){this.route=n,this.router=s,this.postQuery$=y(+this.route.snapshot.params.id,{pollingInterval:5e3}).pipe((0,N.b)(i=>this.postFormControl.setValue(i.data?.name??""))),this.updatePostMutation=C(),this.deletePostMutation=x(),this.postFormControl=new a.p4(""),this.isEditing=!1}updatePost(){this.updatePostMutation.dispatch({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation.dispatch(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing=!this.isEditing}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(l.gz),t.Y36(l.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-post-detail"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],["class","flex items-center space-x-4",4,"ngIf"],[1,"flex","items-center","space-x-4"],["class","btn-outline btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn-outline","btn-primary",3,"disabled","click"],["class","space-x-4",4,"ngIf"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(n,s){1&n&&(t.YNc(0,Y,11,7,"section",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.postQuery$))},dependencies:[r.O5,a.Fj,a.JJ,a.oH,r.Ov,r.Ts],encapsulation:2,changeDetection:0}),o})()}];let S=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(O),l.Bz]}),o})(),$=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[r.ez,S,a.u5,a.UX,T]}),o})()}}]);
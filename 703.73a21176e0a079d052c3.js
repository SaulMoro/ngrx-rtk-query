"use strict";(self.webpackChunkngrx_rtk_query_app=self.webpackChunkngrx_rtk_query_app||[]).push([[703],{7703:(lt,w,_)=>{_.r(w),_.d(w,{PostsModule:()=>at});var d=_(8583),f=_(3092),h=_(4272),Q=_(3215),I=_(9755),M=_(685),t=_(7716);const S=(0,I.ni)({baseUrl:"/"}),F=(0,I.XD)(S,{maxRetries:6}),b=(0,M.LC)({reducerPath:"postsApi",baseQuery:F,tagTypes:["Posts"],endpoints:e=>({getPosts:e.query({query:()=>({url:"posts"}),providesTags:o=>o?[...o.map(({id:n})=>({type:"Posts",id:n})),{type:"Posts",id:"LIST"}]:[{type:"Posts",id:"LIST"}]}),addPost:e.mutation({query:o=>({url:"posts",method:"POST",body:o}),invalidatesTags:[{type:"Posts",id:"LIST"}]}),getPost:e.query({query:o=>`posts/${o}`,providesTags:(o,n,r)=>[{type:"Posts",id:r}]}),updatePost:e.mutation({query:o=>{const{id:n}=o,r=function(e,o){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&o.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)o.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(o,["id"]);return{url:`posts/${n}`,method:"PUT",body:r}},invalidatesTags:(o,n,{id:r})=>[{type:"Posts",id:r}]}),deletePost:e.mutation({query:o=>({url:`posts/${o}`,method:"DELETE"}),invalidatesTags:(o,n,r)=>[{type:"Posts",id:r}]})})}),{useAddPostMutation:j,useDeletePostMutation:E,useGetPostQuery:J,useGetPostsQuery:N,useUpdatePostMutation:q}=b;let D=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[Q.Aw.forFeature(b.reducerPath,b.reducer,{metaReducers:[b.metareducer]})]]}),e})();const U=function(e){return["/posts",e]};function Y(e,o){if(1&e&&(t.TgZ(0,"li"),t.TgZ(1,"a",6),t._uU(2),t.qZA(),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,U,n.id)),t.xp6(1),t.Oqu(n.name)}}function R(e,o){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Y,3,4,"li",5),t.qZA()),2&e){const n=t.oxw().ngIf,r=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n)("ngForTrackBy",r.trackByFn)}}function B(e,o){1&e&&(t.TgZ(0,"p",7),t._uU(1,"No posts :("),t.qZA())}function $(e,o){if(1&e&&(t.ynx(0),t.YNc(1,R,2,2,"div",2),t.YNc(2,B,2,0,"ng-template",null,4,t.W1O),t.BQk()),2&e){const n=o.ngIf,r=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.length)("ngIfElse",r)}}function k(e,o){1&e&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function H(e,o){if(1&e&&(t.TgZ(0,"section",1),t.YNc(1,$,4,2,"ng-container",2),t.YNc(2,k,2,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const n=o.ngIf,r=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.data)("ngIfElse",r)}}let G=(()=>{class e{constructor(){this.postsQuery$=N()}trackByFn(n,r){return r.id}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-posts-list"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(n,r){1&n&&(t.YNc(0,H,4,2,"section",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,r.postsQuery$))},directives:[d.O5,d.sg,h.yS],pipes:[d.Ov],encapsulation:2,changeDetection:0}),e})();function X(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){return t.CHM(n),t.oxw().addNewPost()}),t._uU(1),t.qZA()}if(2&e){const n=o.ngIf,r=t.oxw();t.Q6J("disabled",r.postNameFormControl.invalid||n.isLoading),t.xp6(1),t.hij(" ",n.isLoading?"Adding...":"Add Post"," ")}}let z=(()=>{class e{constructor(){this.addPost=j(),this.postNameFormControl=new f.NI("",[f.kI.required])}addNewPost(){this.addPost.dispatch({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-posts-manager"]],decls:12,vars:4,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],["class","m-4 btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"text-xl","font-semibold"],[1,"m-4","btn","btn-primary",3,"disabled","click"]],template:function(n,r){1&n&&(t.TgZ(0,"section",0),t.TgZ(1,"div"),t._UZ(2,"input",1),t.YNc(3,X,2,2,"button",2),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"h1",3),t._uU(6,"Posts List"),t.qZA(),t._UZ(7,"app-posts-list"),t._UZ(8,"hr"),t.TgZ(9,"h1",3),t._uU(10,"Posts List with duplicate subscription"),t.qZA(),t._UZ(11,"app-posts-list"),t.qZA()),2&n&&(t.xp6(2),t.Q6J("formControl",r.postNameFormControl),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,2,r.addPost.state$)))},directives:[f.Fj,f.JJ,f.oH,d.O5,G],pipes:[d.Ov],encapsulation:2,changeDetection:0}),e})();var V=_(9922);function W(e,o){1&e&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function K(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){return t.CHM(n),t.oxw(4).toggleEdit()}),t._uU(1),t.qZA()}if(2&e){const n=o.ngIf,r=t.oxw().ngIf,i=t.oxw(2).ngIf;t.Q6J("disabled",i.isLoading||r.isLoading||n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Updating...":"Edit"," ")}}function tt(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",8),t.YNc(1,K,2,2,"button",9),t.ALo(2,"async"),t.TgZ(3,"button",10),t.NdJ("click",function(){return t.CHM(n),t.oxw(3).deletePost()}),t._uU(4),t.qZA(),t.TgZ(5,"button",10),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).ngIf.refetch()}),t._uU(6),t.qZA(),t.qZA()}if(2&e){const n=o.ngIf,r=t.oxw(2).ngIf,i=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,5,i.updatePostMutation.state$)),t.xp6(2),t.Q6J("disabled",r.isLoading||n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Deleting...":"Delete"," "),t.xp6(1),t.Q6J("disabled",r.isFetching),t.xp6(1),t.hij(" ",r.isFetching?"Fetching...":"Refresh"," ")}}function et(e,o){if(1&e&&(t.ynx(0),t.YNc(1,tt,7,7,"div",7),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.deletePostMutation.state$))}}function nt(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",12),t._UZ(1,"input",13),t.TgZ(2,"button",14),t.NdJ("click",function(){return t.CHM(n),t.oxw(3).updatePost()}),t._uU(3),t.qZA(),t.TgZ(4,"button",14),t.NdJ("click",function(){return t.CHM(n),t.oxw(3).toggleEdit()}),t._uU(5,"Cancel"),t.qZA(),t.qZA()}if(2&e){const n=o.ngIf,r=t.oxw(3);t.xp6(1),t.Q6J("formControl",r.postFormControl),t.xp6(1),t.Q6J("disabled",n.isLoading),t.xp6(1),t.hij(" ",null!=n&&n.isLoading?"Updating...":"Update"," "),t.xp6(1),t.Q6J("disabled",n.isLoading)}}function ot(e,o){if(1&e&&(t.YNc(0,nt,6,4,"div",11),t.ALo(1,"async")),2&e){const n=t.oxw(2);t.Q6J("ngIf",t.lcZ(1,1,n.updatePostMutation.state$))}}function rt(e,o){if(1&e&&(t.TgZ(0,"section",1),t.TgZ(1,"div"),t.TgZ(2,"h1",2),t._uU(3),t.qZA(),t.YNc(4,W,2,0,"small",3),t.qZA(),t.YNc(5,et,3,3,"ng-container",4),t.YNc(6,ot,2,3,"ng-template",null,5,t.W1O),t.TgZ(8,"pre",6),t._uU(9),t.ALo(10,"json"),t.qZA(),t.qZA()),2&e){const n=o.ngIf,r=t.MAs(7),i=t.oxw();t.xp6(3),t.Oqu(null==n||null==n.data?null:n.data.name),t.xp6(1),t.Q6J("ngIf",n.isFetching),t.xp6(1),t.Q6J("ngIf",!i.isEditing)("ngIfElse",r),t.xp6(4),t.Oqu(t.lcZ(10,5,n.data))}}const st=[{path:"",component:z},{path:":id",component:(()=>{class e{constructor(n,r){this.route=n,this.router=r,this.postQuery$=J(+this.route.snapshot.params.id,{pollingInterval:5e3}).pipe((0,V.b)(i=>{var s,a;return this.postFormControl.setValue(null!==(a=null===(s=i.data)||void 0===s?void 0:s.name)&&void 0!==a?a:"")})),this.updatePostMutation=q(),this.deletePostMutation=E(),this.postFormControl=new f.NI(""),this.isEditing=!1}updatePost(){this.updatePostMutation.dispatch({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation.dispatch(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing=!this.isEditing}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(h.gz),t.Y36(h.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-post-detail"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],["class","flex items-center space-x-4",4,"ngIf"],[1,"flex","items-center","space-x-4"],["class","btn-outline btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn-outline","btn-primary",3,"disabled","click"],["class","space-x-4",4,"ngIf"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(n,r){1&n&&(t.YNc(0,rt,11,7,"section",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,r.postQuery$))},directives:[d.O5,f.Fj,f.JJ,f.oH],pipes:[d.Ov,d.Ts],encapsulation:2,changeDetection:0}),e})()}];let it=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[h.Bz.forChild(st)],h.Bz]}),e})(),at=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.ez,it,f.u5,f.UX,D]]}),e})()}}]);
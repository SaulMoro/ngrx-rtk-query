"use strict";(self.webpackChunkngrx_rtk_query_app=self.webpackChunkngrx_rtk_query_app||[]).push([[384],{4384:(A,d,r)=>{r.r(d),r.d(d,{PostsModule:()=>q});var l=r(1368),a=r(4716),c=r(5760),u=r(4328);const h=(0,c._)({baseUrl:"/"}),C=(0,c.c9)(h,{maxRetries:6}),m=(0,c.KS)({reducerPath:"postsApi",baseQuery:C,tagTypes:["Posts"],endpoints:e=>({getPosts:e.query({query:()=>({url:"posts"}),providesTags:i=>i?[...i.map(({id:s})=>({type:"Posts",id:s})),{type:"Posts",id:"LIST"}]:[{type:"Posts",id:"LIST"}]}),addPost:e.mutation({query:i=>({url:"posts",method:"POST",body:i}),invalidatesTags:[{type:"Posts",id:"LIST"}]}),getPost:e.query({query:i=>`posts/${i}`,providesTags:(i,s,o)=>[{type:"Posts",id:o}]}),updatePost:e.mutation({query:i=>{const{id:s,...o}=i;return{url:`posts/${s}`,method:"PUT",body:o}},invalidatesTags:(i,s,{id:o})=>[{type:"Posts",id:o}]}),deletePost:e.mutation({query:i=>({url:`posts/${i}`,method:"DELETE"}),invalidatesTags:(i,s,o)=>[{type:"Posts",id:o}]})})}),{useAddPostMutation:f,useDeletePostMutation:E,useGetPostQuery:g,useGetPostsQuery:G,useUpdatePostMutation:I}=m;var t=r(4496);const R=e=>["/posts",e];function k(e,i){if(1&e&&(t.I0R(0,"li")(1,"a",5),t.OEk(2),t.C$Y()()),2&e){const s=i.$implicit;t.yG2(),t.E7m("routerLink",t.S45(2,R,s.id)),t.yG2(),t.cNF(s.name)}}function T(e,i){if(1&e&&(t.I0R(0,"div"),t.yuY(1,k,3,4,"li",4),t.C$Y()),2&e){const s=t.GaO().ngIf,o=t.GaO();t.yG2(),t.E7m("ngForOf",s)("ngForTrackBy",o.trackByFn)}}function F(e,i){1&e&&(t.I0R(0,"p",6),t.OEk(1,"No posts :("),t.C$Y())}function v(e,i){if(1&e&&(t.SAx(0),t.yuY(1,T,2,2,"div",1)(2,F,2,0,"ng-template",null,3,t.gJz),t.k70()),2&e){const s=i.ngIf,o=t.Gew(3);t.yG2(),t.E7m("ngIf",s.length)("ngIfElse",o)}}function O(e,i){1&e&&(t.I0R(0,"small"),t.OEk(1,"Loading..."),t.C$Y())}let b=(()=>{class e{constructor(){this.postsQuery=G()}trackByFn(s,o){return o.id}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.In1({type:e,selectors:[["app-posts-list"]],decls:4,vars:2,consts:[[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(o,n){if(1&o&&(t.I0R(0,"section",0),t.yuY(1,v,4,2,"ng-container",1)(2,O,2,0,"ng-template",null,2,t.gJz),t.C$Y()),2&o){const p=t.Gew(3);t.yG2(),t.E7m("ngIf",n.postsQuery.data())("ngIfElse",p)}},dependencies:[l.ay,l.u_,u.ER],encapsulation:2,changeDetection:0})}return e})(),D=(()=>{class e{constructor(){this.addPost=f(),this.postNameFormControl=new a.yM("",[a.AQ.required])}addNewPost(){this.addPost({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.In1({type:e,selectors:[["app-posts-manager"]],decls:12,vars:3,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],[1,"btn","btn-primary","m-4",3,"disabled","click"],[1,"text-xl","font-semibold"]],template:function(o,n){1&o&&(t.I0R(0,"section",0)(1,"div"),t.wR5(2,"input",1),t.I0R(3,"button",2),t.qCj("click",function(){return n.addNewPost()}),t.OEk(4),t.C$Y()(),t.I0R(5,"h1",3),t.OEk(6,"Posts List"),t.C$Y(),t.wR5(7,"app-posts-list")(8,"hr"),t.I0R(9,"h1",3),t.OEk(10,"Posts List with duplicate subscription"),t.C$Y(),t.wR5(11,"app-posts-list"),t.C$Y()),2&o&&(t.yG2(2),t.E7m("formControl",n.postNameFormControl),t.yG2(),t.E7m("disabled",n.postNameFormControl.invalid||n.addPost.isLoading()),t.yG2(),t.oRS(" ",n.addPost.isLoading()?"Adding...":"Add Post"," "))},dependencies:[a.ot,a.ue,a.ug,b],encapsulation:2,changeDetection:0})}return e})();var Q=r(2216),y=r(1824);const{selectQueryParam:L,selectRouteParam:_}=(0,Q.CO)(),Y=(_("id"),(0,y.M3)(_("id"),e=>{const i=Number(e);return isNaN(i)?void 0:i}));function M(e,i){1&e&&(t.I0R(0,"small"),t.OEk(1,"Loading..."),t.C$Y())}function $(e,i){if(1&e){const s=t.KQA();t.SAx(0),t.I0R(1,"div",6)(2,"button",7),t.qCj("click",function(){t.usT(s);const n=t.GaO();return t.CGJ(n.toggleEdit())}),t.OEk(3),t.C$Y(),t.I0R(4,"button",7),t.qCj("click",function(){t.usT(s);const n=t.GaO();return t.CGJ(n.deletePost())}),t.OEk(5),t.C$Y(),t.I0R(6,"button",7),t.qCj("click",function(){t.usT(s);const n=t.GaO();return t.CGJ(n.postQuery.refetch())}),t.OEk(7),t.C$Y()(),t.k70()}if(2&e){const s=t.GaO();t.yG2(2),t.E7m("disabled",s.postQuery.isLoading()||s.deletePostMutation.isLoading()||s.updatePostMutation.isLoading()),t.yG2(),t.oRS(" ",s.updatePostMutation.isLoading()?"Updating...":"Edit"," "),t.yG2(),t.E7m("disabled",s.postQuery.isLoading()||s.deletePostMutation.isLoading()),t.yG2(),t.oRS(" ",s.deletePostMutation.isLoading()?"Deleting...":"Delete"," "),t.yG2(),t.E7m("disabled",s.postQuery.isFetching()),t.yG2(),t.oRS(" ",s.postQuery.isFetching()?"Fetching...":"Refresh"," ")}}function x(e,i){if(1&e){const s=t.KQA();t.I0R(0,"div",8),t.wR5(1,"input",9),t.I0R(2,"button",10),t.qCj("click",function(){t.usT(s);const n=t.GaO();return t.CGJ(n.updatePost())}),t.OEk(3),t.C$Y(),t.I0R(4,"button",10),t.qCj("click",function(){t.usT(s);const n=t.GaO();return t.CGJ(n.toggleEdit())}),t.OEk(5," Cancel "),t.C$Y()()}if(2&e){const s=t.GaO();t.yG2(),t.E7m("formControl",s.postFormControl),t.yG2(),t.E7m("disabled",s.updatePostMutation.isLoading()),t.yG2(),t.oRS(" ",s.updatePostMutation.isLoading()?"Updating...":"Update"," "),t.yG2(),t.E7m("disabled",s.updatePostMutation.isLoading())}}function N(e,i){if(1&e&&(t.I0R(0,"h3"),t.OEk(1,"Dynamic router arg and selectFromResult"),t.C$Y(),t.I0R(2,"pre",5),t.OEk(3),t.C$Y()),2&e){const s=t.GaO();t.yG2(3),t.oRS("Name: ",s.postDinamicQuery().name,"")}}L("page");const w=[{path:"",component:D},{path:":id",component:(()=>{class e{#t;#e;constructor(s,o){this.route=s,this.router=o,this.postQuery=g(+this.route.snapshot.params.id,{pollingInterval:5e3}),this.#t=(0,t.uUt)(y.m_).selectSignal(Y),this.postDinamicQuery=g(()=>this.#t()??c.W9,{pollingInterval:5e3,selectFromResult:n=>({...n,name:n.data?.name})}),this.#e=(0,t.o3l)(()=>{const n=this.postQuery();this.postFormControl.setValue(n.data?.name??"")}),this.updatePostMutation=I(),this.deletePostMutation=E(),this.postFormControl=new a.yM(""),this.isEditing=(0,t.OCB)(!1)}updatePost(){this.updatePostMutation({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing.update(s=>!s)}static#s=this.\u0275fac=function(o){return new(o||e)(t.GI1(u.gV),t.GI1(u.E5))};static#o=this.\u0275cmp=t.In1({type:e,selectors:[["app-post-detail"]],decls:12,vars:8,consts:[[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],[1,"flex","items-center","space-x-4"],[1,"btn-outline","btn-primary",3,"disabled","click"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(o,n){if(1&o&&(t.I0R(0,"section",0)(1,"div")(2,"h1",1),t.OEk(3),t.C$Y(),t.yuY(4,M,2,0,"small",2),t.C$Y(),t.yuY(5,$,8,6,"ng-container",3)(6,x,6,4,"ng-template",null,4,t.gJz),t.I0R(8,"pre",5),t.OEk(9),t.wVc(10,"json"),t.C$Y(),t.yuY(11,N,4,1),t.C$Y()),2&o){const p=t.Gew(7);let P;t.yG2(3),t.cNF(null==(P=n.postQuery.data())?null:P.name),t.yG2(),t.E7m("ngIf",n.postQuery.isFetching()),t.yG2(),t.E7m("ngIf",!n.isEditing())("ngIfElse",p),t.yG2(4),t.cNF(t.kDX(10,6,n.postQuery.data())),t.yG2(2),t.C0Y(11,n.postDinamicQuery.isFetching()||n.postDinamicQuery.isError()||!n.postDinamicQuery.data()?-1:11)}},dependencies:[l.u_,a.ot,a.ue,a.ug,l.ED],encapsulation:2,changeDetection:0})}return e})()}];let S=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.a4G({type:e});static#s=this.\u0275inj=t.s3X({imports:[u.qQ.forChild(w),u.qQ]})}return e})(),q=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.a4G({type:e});static#s=this.\u0275inj=t.s3X({providers:[(0,c.QR)(m)],imports:[l.MD,S,a.y,a.sl]})}return e})()}}]);
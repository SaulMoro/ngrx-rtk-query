(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{YanU:function(t,n,e){"use strict";e.r(n),e.d(n,"PostsModule",function(){return C});var s=e("ofXK"),o=e("3Pt+"),i=e("tyNb"),a=e("fXoL"),c=e("l7P3"),r=e("JC0d"),b=e("nSkL");async function l(t=0,n=5){const e=Math.min(t,n),s=~~((Math.random()+.4)*(300<<e));await new Promise(t=>setTimeout(n=>t(n),s))}const u=Object.assign((t,n)=>async(e,s,o)=>{const i={maxRetries:5,backoff:l,...n,...o};let a=0;for(;;)try{const n=await t(e,s,o);if(n.error)throw new b.a(n);return n}catch(c){if(a++,c.throwImmediately||a>i.maxRetries){if(c instanceof b.a)return c.value;throw c}await i.backoff(a,i.maxRetries)}},{fail:function(t){throw Object.assign(new b.a({error:t}),{throwImmediately:!0})}});var d=e("1bI8");const p=u(Object(r.a)({baseUrl:"/"}),{maxRetries:6}),f=Object(d.b)({reducerPath:"postsApi",baseQuery:p,entityTypes:["Posts"],endpoints:t=>({getPosts:t.query({query:()=>({url:"posts"}),provides:t=>[...t.map(({id:t})=>({type:"Posts",id:t})),{type:"Posts",id:"LIST"}]}),addPost:t.mutation({query:t=>({url:"posts",method:"POST",body:t}),invalidates:[{type:"Posts",id:"LIST"}]}),getPost:t.query({query:t=>`posts/${t}`,provides:(t,n)=>[{type:"Posts",id:n}]}),updatePost:t.mutation({query(t){const{id:n}=t;return{url:`posts/${n}`,method:"PUT",body:function(t,n){var e={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(e[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(t);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(t,s[o])&&(e[s[o]]=t[s[o]])}return e}(t,["id"])}},invalidates:(t,{id:n})=>[{type:"Posts",id:n}]}),deletePost:t.mutation({query:t=>({url:`posts/${t}`,method:"DELETE"}),invalidates:(t,n)=>[{type:"Posts",id:n}]})})}),{useAddPostMutation:g,useDeletePostMutation:m,useGetPostQuery:y,useGetPostsQuery:h,useUpdatePostMutation:P}=f;let L=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({imports:[[c.i.forFeature(f.reducerPath,f.reducer,{metaReducers:[f.metareducer]})]]}),t})();function I(t,n){if(1&t){const t=a.Nb();a.Mb(0,"button",2),a.Tb("click",function(){return a.dc(t),a.Vb().handleAddPost()}),a.ic(1),a.Lb()}if(2&t){const t=n.ngIf;a.Yb("disabled",t.isLoading),a.zb(1),a.kc(" ",t.isLoading?"Adding...":"Add Post"," ")}}let w=(()=>{class t{constructor(){this.postFormControl=new o.b(""),this.addPostMutation=g()}handleAddPost(){this.addPostMutation.dispatch({name:this.postFormControl.value})}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=a.Db({type:t,selectors:[["app-new-post"]],decls:3,vars:4,consts:[["placeholder","New post name","type","text",3,"formControl"],["class","m-4 btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"m-4","btn","btn-primary",3,"disabled","click"]],template:function(t,n){1&t&&(a.Kb(0,"input",0),a.gc(1,I,2,2,"button",1),a.Wb(2,"async")),2&t&&(a.Yb("formControl",n.postFormControl),a.zb(1),a.Yb("ngIf",a.Xb(2,2,n.addPostMutation.state$)))},directives:[o.a,o.e,o.c,s.k],pipes:[s.b],encapsulation:2,changeDetection:0}),t})();function M(t,n){1&t&&(a.Mb(0,"small"),a.ic(1,"Loading..."),a.Lb())}const v=function(t){return["/posts",t]};function k(t,n){if(1&t&&(a.Mb(0,"li"),a.Mb(1,"a",6),a.ic(2),a.Lb(),a.Lb()),2&t){const t=n.$implicit;a.zb(1),a.Yb("routerLink",a.ac(2,v,t.id)),a.zb(1),a.jc(t.name)}}function j(t,n){if(1&t&&(a.Mb(0,"div"),a.gc(1,k,3,4,"li",5),a.Lb()),2&t){const t=a.Vb().ngIf,n=a.Vb();a.zb(1),a.Yb("ngForOf",null==t?null:t.data)("ngForTrackBy",n.trackByFn)}}function O(t,n){1&t&&(a.Mb(0,"p",7),a.ic(1,"No posts :("),a.Lb())}function x(t,n){if(1&t&&(a.Mb(0,"section",1),a.gc(1,M,2,0,"small",2),a.gc(2,j,2,2,"div",3),a.gc(3,O,2,0,"ng-template",null,4,a.hc),a.Lb()),2&t){const t=n.ngIf,e=a.cc(4);a.zb(1),a.Yb("ngIf",t.isLoading),a.zb(1),a.Yb("ngIf",null==t||null==t.data?null:t.data.length)("ngIfElse",e)}}let z=(()=>{class t{constructor(){this.postsQuery$=h()}trackByFn(t,n){return n.id}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=a.Db({type:t,selectors:[["app-posts-list"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["noPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(t,n){1&t&&(a.gc(0,x,5,3,"section",0),a.Wb(1,"async")),2&t&&a.Yb("ngIf",a.Xb(1,1,n.postsQuery$))},directives:[s.k,s.j,i.i],pipes:[s.b],encapsulation:2,changeDetection:0}),t})(),Y=(()=>{class t{constructor(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=a.Db({type:t,selectors:[["app-posts-manager"]],decls:9,vars:0,consts:[[1,"space-y-8"],[1,"text-xl","font-semibold"]],template:function(t,n){1&t&&(a.Mb(0,"section",0),a.Kb(1,"app-new-post"),a.Mb(2,"h1",1),a.ic(3,"Posts List"),a.Lb(),a.Kb(4,"app-posts-list"),a.Kb(5,"hr"),a.Mb(6,"h1",1),a.ic(7,"Posts List with duplicate subscription"),a.Lb(),a.Kb(8,"app-posts-list"),a.Lb())},directives:[w,z],encapsulation:2,changeDetection:0}),t})();var D=e("lJxs");function F(t,n){1&t&&(a.Mb(0,"small"),a.ic(1,"Refetching..."),a.Lb())}function T(t,n){if(1&t&&(a.Mb(0,"button",9),a.ic(1),a.Lb()),2&t){const t=n.ngIf,e=a.Vb().ngIf,s=a.Vb().ngIf;a.Yb("disabled",s.isLoading||e.isLoading||t.isLoading),a.zb(1),a.kc(" ",null!=t&&t.isLoading?"Updating...":"Edit"," ")}}function $(t,n){if(1&t){const t=a.Nb();a.Mb(0,"div",6),a.gc(1,T,2,2,"button",7),a.Wb(2,"async"),a.Mb(3,"button",8),a.Tb("click",function(){a.dc(t);const n=a.Vb().ngIf;return a.Vb().deletePost(null==n.data?null:n.data.id)}),a.ic(4),a.Lb(),a.Lb()}if(2&t){const t=n.ngIf,e=a.Vb().ngIf,s=a.Vb();a.zb(1),a.Yb("ngIf",a.Xb(2,3,s.updatePostMutation.state$)),a.zb(2),a.Yb("disabled",e.isLoading||t.isLoading),a.zb(1),a.kc(" ",null!=t&&t.isLoading?"Deleting...":"Delete"," ")}}function V(t,n){if(1&t&&(a.Mb(0,"section",1),a.Mb(1,"div"),a.Mb(2,"h1",2),a.ic(3),a.Lb(),a.gc(4,F,2,0,"small",3),a.Lb(),a.gc(5,$,5,5,"div",4),a.Wb(6,"async"),a.Mb(7,"pre",5),a.ic(8),a.Wb(9,"json"),a.Lb(),a.Lb()),2&t){const t=n.ngIf,e=a.Vb();a.zb(3),a.jc(null==t||null==t.data?null:t.data.name),a.zb(1),a.Yb("ngIf",t.isFetching),a.zb(1),a.Yb("ngIf",a.Xb(6,4,e.deletePostMutation.state$)),a.zb(3),a.jc(a.Xb(9,6,t.data))}}const X=[{path:"",component:Y},{path:":id",component:(()=>{class t{constructor(t,n){this.route=t,this.router=n,this.postQuery$=y(this.route.params.pipe(Object(D.a)(t=>+t.id))),this.updatePostMutation=P(),this.deletePostMutation=m()}updatePost(t){}deletePost(t=0){this.deletePostMutation.dispatch(t),this.router.navigate(["/posts"])}}return t.\u0275fac=function(n){return new(n||t)(a.Jb(i.a),a.Jb(i.g))},t.\u0275cmp=a.Db({type:t,selectors:[["app-post-detail"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],["class","flex items-center space-x-4",4,"ngIf"],[1,"bg-gray-200"],[1,"flex","items-center","space-x-4"],["class","btn-outline btn-primary",3,"disabled",4,"ngIf"],[1,"m-4","btn-outline","btn-primary",3,"disabled","click"],[1,"btn-outline","btn-primary",3,"disabled"]],template:function(t,n){1&t&&(a.gc(0,V,10,8,"section",0),a.Wb(1,"async")),2&t&&a.Yb("ngIf",a.Xb(1,1,n.postQuery$))},directives:[s.k],pipes:[s.b,s.f],encapsulation:2,changeDetection:0}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({imports:[[i.j.forChild(X)],i.j]}),t})(),C=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.Hb({type:t}),t.\u0275inj=a.Gb({imports:[[s.c,q,o.d,o.h,L]]}),t})()}}]);
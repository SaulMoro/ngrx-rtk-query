"use strict";(self.webpackChunkngrx_rtk_query_app=self.webpackChunkngrx_rtk_query_app||[]).push([[971],{971:(I,d,r)=>{r.r(d),r.d(d,{PostsModule:()=>E});var p=r(4755),a=r(5030),c=r(9140),l=r(3584),g=r(7729);const _=(0,c.ni)({baseUrl:"/"}),P=(0,g.XD)(_,{maxRetries:6}),m=(0,c.LC)({reducerPath:"postsApi",baseQuery:P,tagTypes:["Posts"],endpoints:o=>({getPosts:o.query({query:()=>({url:"posts"}),providesTags:s=>s?[...s.map(({id:e})=>({type:"Posts",id:e})),{type:"Posts",id:"LIST"}]:[{type:"Posts",id:"LIST"}]}),addPost:o.mutation({query:s=>({url:"posts",method:"POST",body:s}),invalidatesTags:[{type:"Posts",id:"LIST"}]}),getPost:o.query({query:s=>`posts/${s}`,providesTags:(s,e,n)=>[{type:"Posts",id:n}]}),updatePost:o.mutation({query:s=>{const{id:e,...n}=s;return{url:`posts/${e}`,method:"PUT",body:n}},invalidatesTags:(s,e,{id:n})=>[{type:"Posts",id:n}]}),deletePost:o.mutation({query:s=>({url:`posts/${s}`,method:"DELETE"}),invalidatesTags:(s,e,n)=>[{type:"Posts",id:n}]})})}),{useAddPostMutation:f,useDeletePostMutation:h,useGetPostQuery:y,useGetPostsQuery:x,useUpdatePostMutation:C}=m;var t=r(2223);const T=function(o){return["/posts",o]};function Z(o,s){if(1&o&&(t.TgZ(0,"li")(1,"a",5),t._uU(2),t.qZA()()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,T,e.id)),t.xp6(1),t.Oqu(e.name)}}function v(o,s){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,Z,3,4,"li",4),t.qZA()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",n.trackByFn)}}function M(o,s){1&o&&(t.TgZ(0,"p",6),t._uU(1,"No posts :("),t.qZA())}function Q(o,s){if(1&o&&(t.ynx(0),t.YNc(1,v,2,2,"div",1),t.YNc(2,M,2,0,"ng-template",null,3,t.W1O),t.BQk()),2&o){const e=s.ngIf,n=t.MAs(3);t.xp6(1),t.Q6J("ngIf",e.length)("ngIfElse",n)}}function L(o,s){1&o&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}let F=(()=>{class o{constructor(){this.postsQuery=x()}trackByFn(e,n){return n.id}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-list"]],decls:4,vars:2,consts:[[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(e,n){if(1&e&&(t.TgZ(0,"section",0),t.YNc(1,Q,4,2,"ng-container",1),t.YNc(2,L,2,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){const i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.postsQuery().data)("ngIfElse",i)}},dependencies:[p.sg,p.O5,l.rH],encapsulation:2,changeDetection:0}),o})(),A=(()=>{class o{constructor(){this.addPost=f(),this.postNameFormControl=new a.p4("",[a.kI.required])}addNewPost(){this.addPost.dispatch({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts-manager"]],decls:12,vars:3,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],[1,"btn","btn-primary","m-4",3,"disabled","click"],[1,"text-xl","font-semibold"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"div"),t._UZ(2,"input",1),t.TgZ(3,"button",2),t.NdJ("click",function(){return n.addNewPost()}),t._uU(4),t.qZA()(),t.TgZ(5,"h1",3),t._uU(6,"Posts List"),t.qZA(),t._UZ(7,"app-posts-list")(8,"hr"),t.TgZ(9,"h1",3),t._uU(10,"Posts List with duplicate subscription"),t.qZA(),t._UZ(11,"app-posts-list"),t.qZA()),2&e&&(t.xp6(2),t.Q6J("formControl",n.postNameFormControl),t.xp6(1),t.Q6J("disabled",n.postNameFormControl.invalid||n.addPost.state().isLoading),t.xp6(1),t.hij(" ",n.addPost.state().isLoading?"Adding...":"Add Post"," "))},dependencies:[a.Fj,a.JJ,a.oH,F],encapsulation:2,changeDetection:0}),o})();var b=r(5926),J=r(3359);function U(o,s){1&o&&(t.TgZ(0,"small"),t._uU(1,"Loading..."),t.qZA())}function q(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleEdit())}),t._uU(3),t.qZA(),t.TgZ(4,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deletePost())}),t._uU(5),t.qZA(),t.TgZ(6,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.postQuery().refetch())}),t._uU(7),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.postQuery().isLoading||e.deletePostMutation.state().isLoading||e.updatePostMutation.state().isLoading),t.xp6(1),t.hij(" ",e.updatePostMutation.state().isLoading?"Updating...":"Edit"," "),t.xp6(1),t.Q6J("disabled",e.postQuery().isLoading||e.deletePostMutation.state().isLoading),t.xp6(1),t.hij(" ",e.deletePostMutation.state().isLoading?"Deleting...":"Delete"," "),t.xp6(1),t.Q6J("disabled",e.postQuery().isFetching),t.xp6(1),t.hij(" ",e.postQuery().isFetching?"Fetching...":"Refresh"," ")}}function N(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",8),t._UZ(1,"input",9),t.TgZ(2,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updatePost())}),t._uU(3),t.qZA(),t.TgZ(4,"button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleEdit())}),t._uU(5," Cancel "),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formControl",e.postFormControl),t.xp6(1),t.Q6J("disabled",e.updatePostMutation.state().isLoading),t.xp6(1),t.hij(" ",e.updatePostMutation.state().isLoading?"Updating...":"Update"," "),t.xp6(1),t.Q6J("disabled",e.updatePostMutation.state().isLoading)}}const k=[{path:"",component:A},{path:":id",component:(()=>{var o=new WeakMap;class s{constructor(n,i){(0,b.Z)(this,o,{writable:!0,value:void 0}),this.route=n,this.router=i,this.postQuery=y(+this.route.snapshot.params.id,{pollingInterval:5e3}),(0,J.Z)(this,o,(0,t.cEC)(()=>{const u=this.postQuery();this.postFormControl.setValue(u.data?.name??"")})),this.updatePostMutation=C(),this.deletePostMutation=h(),this.postFormControl=new a.p4(""),this.isEditing=(0,t.tdS)(!1)}updatePost(){this.updatePostMutation.dispatch({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation.dispatch(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing.update(n=>!n)}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(l.gz),t.Y36(l.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-post-detail"]],decls:11,vars:7,consts:[[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],[1,"flex","items-center","space-x-4"],[1,"btn-outline","btn-primary",3,"disabled","click"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(n,i){if(1&n&&(t.TgZ(0,"section",0)(1,"div")(2,"h1",1),t._uU(3),t.qZA(),t.YNc(4,U,2,0,"small",2),t.qZA(),t.YNc(5,q,8,6,"ng-container",3),t.YNc(6,N,6,4,"ng-template",null,4,t.W1O),t.TgZ(8,"pre",5),t._uU(9),t.ALo(10,"json"),t.qZA()()),2&n){const u=t.MAs(7);t.xp6(3),t.Oqu(null==i.postQuery().data?null:i.postQuery().data.name),t.xp6(1),t.Q6J("ngIf",i.postQuery().isFetching),t.xp6(1),t.Q6J("ngIf",!i.isEditing())("ngIfElse",u),t.xp6(4),t.Oqu(t.lcZ(10,5,i.postQuery().data))}},dependencies:[p.O5,a.Fj,a.JJ,a.oH,p.Ts],encapsulation:2,changeDetection:0}),s})()}];let D=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.Bz.forChild(k),l.Bz]}),o})(),E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[(0,c.Nw)(m)],imports:[p.ez,D,a.u5,a.UX]}),o})()}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{YanU:function(t,n,e){"use strict";e.r(n),e.d(n,"PostsModule",function(){return S});var s=e("ofXK"),o=e("3Pt+"),c=e("tyNb"),i=e("l7P3"),a=e("JC0d"),r=e("nSkL");async function b(t=0,n=5){const e=Math.min(t,n),s=~~((Math.random()+.4)*(300<<e));await new Promise(t=>setTimeout(n=>t(n),s))}const l=Object.assign((t,n)=>async(e,s,o)=>{const c={maxRetries:5,backoff:b,...n,...o};let i=0;for(;;)try{const n=await t(e,s,o);if(n.error)throw new r.a(n);return n}catch(a){if(i++,a.throwImmediately||i>c.maxRetries){if(a instanceof r.a)return a.value;throw a}await c.backoff(i,c.maxRetries)}},{fail:function(t){throw Object.assign(new r.a({error:t}),{throwImmediately:!0})}});var u=e("1bI8"),d=e("fXoL");const p=l(Object(a.a)({baseUrl:"/"}),{maxRetries:6}),f=Object(u.b)({reducerPath:"postsApi",baseQuery:p,entityTypes:["Posts"],endpoints:t=>({getPosts:t.query({query:()=>({url:"posts"}),provides:t=>[...t.map(({id:t})=>({type:"Posts",id:t})),{type:"Posts",id:"LIST"}]}),addPost:t.mutation({query:t=>({url:"posts",method:"POST",body:t}),invalidates:[{type:"Posts",id:"LIST"}]}),getPost:t.query({query:t=>`posts/${t}`,provides:(t,n)=>[{type:"Posts",id:n}]}),updatePost:t.mutation({query:t=>{const{id:n}=t;return{url:`posts/${n}`,method:"PUT",body:function(t,n){var e={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(e[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(t);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(t,s[o])&&(e[s[o]]=t[s[o]])}return e}(t,["id"])}},invalidates:(t,{id:n})=>[{type:"Posts",id:n}]}),deletePost:t.mutation({query:t=>({url:`posts/${t}`,method:"DELETE"}),invalidates:(t,n)=>[{type:"Posts",id:n}]})})}),{useAddPostMutation:g,useDeletePostMutation:m,useGetPostQuery:h,useGetPostsQuery:y,useUpdatePostMutation:P}=f;let I=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({imports:[[i.i.forFeature(f.reducerPath,f.reducer,{metaReducers:[f.metareducer]})]]}),t})();const k=function(t){return["/posts",t]};function O(t,n){if(1&t&&(d.Ob(0,"li"),d.Ob(1,"a",6),d.mc(2),d.Nb(),d.Nb()),2&t){const t=n.$implicit;d.zb(1),d.cc("routerLink",d.ec(2,k,t.id)),d.zb(1),d.nc(t.name)}}function v(t,n){if(1&t&&(d.Ob(0,"div"),d.kc(1,O,3,4,"li",5),d.Nb()),2&t){const t=d.Zb().ngIf,n=d.Zb(2);d.zb(1),d.cc("ngForOf",t)("ngForTrackBy",n.trackByFn)}}function w(t,n){1&t&&(d.Ob(0,"p",7),d.mc(1,"No posts :("),d.Nb())}function N(t,n){if(1&t&&(d.Mb(0),d.kc(1,v,2,2,"div",2),d.kc(2,w,2,0,"ng-template",null,4,d.lc),d.Lb()),2&t){const t=n.ngIf,e=d.gc(3);d.zb(1),d.cc("ngIf",t.length)("ngIfElse",e)}}function L(t,n){1&t&&(d.Ob(0,"small"),d.mc(1,"Loading..."),d.Nb())}function z(t,n){if(1&t&&(d.Ob(0,"section",1),d.kc(1,N,4,2,"ng-container",2),d.kc(2,L,2,0,"ng-template",null,3,d.lc),d.Nb()),2&t){const t=n.ngIf,e=d.gc(3);d.zb(1),d.cc("ngIf",t.data)("ngIfElse",e)}}let F=(()=>{class t{constructor(){this.postsQuery$=y()}trackByFn(t,n){return n.id}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=d.Db({type:t,selectors:[["app-posts-list"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[4,"ngIf","ngIfElse"],["loading",""],["emptyPosts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:underline",3,"routerLink"],[1,"mt-4"]],template:function(t,n){1&t&&(d.kc(0,z,4,2,"section",0),d.ac(1,"async")),2&t&&d.cc("ngIf",d.bc(1,1,n.postsQuery$))},directives:[s.l,s.k,c.j],pipes:[s.b],encapsulation:2,changeDetection:0}),t})();function E(t,n){if(1&t){const t=d.Pb();d.Ob(0,"button",4),d.Vb("click",function(){return d.hc(t),d.Zb().addNewPost()}),d.mc(1),d.Nb()}if(2&t){const t=n.ngIf,e=d.Zb();d.cc("disabled",e.postNameFormControl.invalid||t.isLoading),d.zb(1),d.oc(" ",t.isLoading?"Adding...":"Add Post"," ")}}let x=(()=>{class t{constructor(){this.addPost=g(),this.postNameFormControl=new o.b("",[o.j.required])}addNewPost(){this.addPost.dispatch({name:this.postNameFormControl.value}).unwrap().then(()=>this.postNameFormControl.setValue(""))}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=d.Db({type:t,selectors:[["app-posts-manager"]],decls:12,vars:4,consts:[[1,"space-y-4"],["id","name","placeholder","New post name","type","text",3,"formControl"],["class","m-4 btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"text-xl","font-semibold"],[1,"m-4","btn","btn-primary",3,"disabled","click"]],template:function(t,n){1&t&&(d.Ob(0,"section",0),d.Ob(1,"div"),d.Kb(2,"input",1),d.kc(3,E,2,2,"button",2),d.ac(4,"async"),d.Nb(),d.Ob(5,"h1",3),d.mc(6,"Posts List"),d.Nb(),d.Kb(7,"app-posts-list"),d.Kb(8,"hr"),d.Ob(9,"h1",3),d.mc(10,"Posts List with duplicate subscription"),d.Nb(),d.Kb(11,"app-posts-list"),d.Nb()),2&t&&(d.zb(2),d.cc("formControl",n.postNameFormControl),d.zb(1),d.cc("ngIf",d.bc(4,2,n.addPost.state$)))},directives:[o.a,o.e,o.c,s.l,F],pipes:[s.b],encapsulation:2,changeDetection:0}),t})();var Z=e("vkgz");function C(t,n){1&t&&(d.Ob(0,"small"),d.mc(1,"Loading..."),d.Nb())}function j(t,n){if(1&t){const t=d.Pb();d.Ob(0,"button",10),d.Vb("click",function(){return d.hc(t),d.Zb(4).toggleEdit()}),d.mc(1),d.Nb()}if(2&t){const t=n.ngIf,e=d.Zb().ngIf,s=d.Zb(2).ngIf;d.cc("disabled",s.isLoading||e.isLoading||t.isLoading),d.zb(1),d.oc(" ",null!=t&&t.isLoading?"Updating...":"Edit"," ")}}function M(t,n){if(1&t){const t=d.Pb();d.Ob(0,"div",8),d.kc(1,j,2,2,"button",9),d.ac(2,"async"),d.Ob(3,"button",10),d.Vb("click",function(){return d.hc(t),d.Zb(3).deletePost()}),d.mc(4),d.Nb(),d.Ob(5,"button",10),d.Vb("click",function(){return d.hc(t),d.Zb(2).ngIf.refetch()}),d.mc(6),d.Nb(),d.Nb()}if(2&t){const t=n.ngIf,e=d.Zb(2).ngIf,s=d.Zb();d.zb(1),d.cc("ngIf",d.bc(2,5,s.updatePostMutation.state$)),d.zb(2),d.cc("disabled",e.isLoading||t.isLoading),d.zb(1),d.oc(" ",null!=t&&t.isLoading?"Deleting...":"Delete"," "),d.zb(1),d.cc("disabled",e.isFetching),d.zb(1),d.oc(" ",e.isFetching?"Fetching...":"Refresh"," ")}}function $(t,n){if(1&t&&(d.Mb(0),d.kc(1,M,7,7,"div",7),d.ac(2,"async"),d.Lb()),2&t){const t=d.Zb(2);d.zb(1),d.cc("ngIf",d.bc(2,1,t.deletePostMutation.state$))}}function D(t,n){if(1&t){const t=d.Pb();d.Ob(0,"div",12),d.Kb(1,"input",13),d.Ob(2,"button",14),d.Vb("click",function(){return d.hc(t),d.Zb(3).updatePost()}),d.mc(3),d.Nb(),d.Ob(4,"button",14),d.Vb("click",function(){return d.hc(t),d.Zb(3).toggleEdit()}),d.mc(5,"Cancel"),d.Nb(),d.Nb()}if(2&t){const t=n.ngIf,e=d.Zb(3);d.zb(1),d.cc("formControl",e.postFormControl),d.zb(1),d.cc("disabled",t.isLoading),d.zb(1),d.oc(" ",null!=t&&t.isLoading?"Updating...":"Update"," "),d.zb(1),d.cc("disabled",t.isLoading)}}function T(t,n){if(1&t&&(d.kc(0,D,6,4,"div",11),d.ac(1,"async")),2&t){const t=d.Zb(2);d.cc("ngIf",d.bc(1,1,t.updatePostMutation.state$))}}function q(t,n){if(1&t&&(d.Ob(0,"section",1),d.Ob(1,"div"),d.Ob(2,"h1",2),d.mc(3),d.Nb(),d.kc(4,C,2,0,"small",3),d.Nb(),d.kc(5,$,3,3,"ng-container",4),d.kc(6,T,2,3,"ng-template",null,5,d.lc),d.Ob(8,"pre",6),d.mc(9),d.ac(10,"json"),d.Nb(),d.Nb()),2&t){const t=n.ngIf,e=d.gc(7),s=d.Zb();d.zb(3),d.nc(null==t||null==t.data?null:t.data.name),d.zb(1),d.cc("ngIf",t.isFetching),d.zb(1),d.cc("ngIf",!s.isEditing)("ngIfElse",e),d.zb(4),d.nc(d.bc(10,5,t.data))}}const V=[{path:"",component:x},{path:":id",component:(()=>{class t{constructor(t,n){this.route=t,this.router=n,this.postQuery$=h(+this.route.snapshot.params.id).pipe(Object(Z.a)(t=>{var n,e;return this.postFormControl.setValue(null!==(e=null===(n=t.data)||void 0===n?void 0:n.name)&&void 0!==e?e:"")})),this.updatePostMutation=P(),this.deletePostMutation=m(),this.postFormControl=new o.b(""),this.isEditing=!1}updatePost(){this.updatePostMutation.dispatch({id:+this.route.snapshot.params.id,name:this.postFormControl.value}).unwrap().then(()=>this.toggleEdit())}deletePost(){this.deletePostMutation.dispatch(+this.route.snapshot.params.id).unwrap().then(()=>this.router.navigate(["/posts"])).catch(()=>console.error("Error deleting Post"))}toggleEdit(){this.isEditing=!this.isEditing}}return t.\u0275fac=function(n){return new(n||t)(d.Jb(c.a),d.Jb(c.g))},t.\u0275cmp=d.Db({type:t,selectors:[["app-post-detail"]],decls:2,vars:3,consts:[["class","space-y-4",4,"ngIf"],[1,"space-y-4"],[1,"text-xl","font-semibold"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["editionSection",""],[1,"bg-gray-200"],["class","flex items-center space-x-4",4,"ngIf"],[1,"flex","items-center","space-x-4"],["class","btn-outline btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn-outline","btn-primary",3,"disabled","click"],["class","space-x-4",4,"ngIf"],[1,"space-x-4"],["type","text",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(t,n){1&t&&(d.kc(0,q,11,7,"section",0),d.ac(1,"async")),2&t&&d.cc("ngIf",d.bc(1,1,n.postQuery$))},directives:[s.l,o.a,o.e,o.c],pipes:[s.b,s.f],encapsulation:2,changeDetection:0}),t})()}];let Q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({imports:[[c.k.forChild(V)],c.k]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({imports:[[s.c,Q,o.d,o.h,I]]}),t})()}}]);